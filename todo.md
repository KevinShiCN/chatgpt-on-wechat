##抽卡场景的兼容性问题

  问题： 抽卡生成多张图片，"改图"不知道基于哪张修改

  方案对比

  | 方案            | 描述                     | 优点     | 缺点           |
  |-----------------|--------------------------|----------|----------------|
  | A. 编号选择     | 改图3 xxx 修改第3张      | 灵活精确 | 用户需记住编号 |
  | B. 默认最后一张 | 只保存最后一张           | 简单     | 不够灵活       |
  | C. 引用回复     | 引用某张图片修改         | 直观     | 平台支持有限   |
  | D. 分场景处理   | 普通生图支持，抽卡不支持 | 简单安全 | 功能受限       |

  推荐方案：A + D组合

  设计思路：

  普通生图 → 保存1张 → "改图 xxx" 直接修改

  抽卡N张→ 保存N张（带编号）→需要指定编号- "改图1 xxx" → 修改第1张
    - "改图3 xxx" → 修改第3张
    - "改图xxx"  → 提示"请指定编号，如：改图1 xxx"

  缓存结构调整：
  IMAGE_GENERATION_CACHE = {
      session_id: {
          "type": "single" | "gacha",  # 区分类型
          "results": [  # 结果列表
              {"url": "...", "prompt": "...", "index": 1},
              {"url": "...", "prompt": "...", "index": 2},
              ...
          ],
          "time": timestamp
      }
  }

  用户交互示例：
  # 普通生图
  用户: 生图 一只猫
  系统: [图片]
  用户: 改图 换成狗
  系统: [修改后的图片]

  # 抽卡
  用户: 抽卡3一只猫
  系统: [图片1]第1/3张
  系统: [图片2] 第2/3张
  系统: [图片3] 第3/3张
  系统: "抽卡完成！如需修改，请使用'改图N xxx'，如：改图2 换成狗"

  用户: 改图2 换成狗
  系统: [基于第2张修改]

  ---
  您觉得这个方案如何？是否需要我更新规划文档？

  这是一个抽卡+改图的todo文档，备用